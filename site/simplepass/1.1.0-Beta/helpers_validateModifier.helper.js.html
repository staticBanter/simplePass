<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>simplePass Docs: Source: helpers/validateModifier.helper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: helpers/validateModifier.helper.js</h1>

    



    

<section>
    <article>
        <pre class="prettyprint source linenums"><code>'use strict';
import L_useableAttributes from "../data/lists/usableAttributes.list.js";
import L_requiredAttributes from "../data/lists/requiredAttributes.list.js";
import config from "../config.simplePass.js";
import createMessage from "./createMessage.helper.js";
import E_errors from "../data/enums/errors.enum.js";
/**
 * @file Contains validation function for the simplePass modifier. Exports `validateModifier`.
 * @module validateModifier
 */
/**
 * A basic validation function used to ensure the set modifier attributes are usable.
 * **WARNING!** simplePass does not preform comprehensive input sanitization/validation at the moment,
 * please ensure you are sanitizing and validating any inputs before they reach your server/application!
 *
 * @function validateModifier
 * @param {I_passwordModifier} modifier
 * @requires createMessage
 * @requires E_errors
 * @requires config
 * @requires L_useableAttributes
 * @requires L_requiredAttributes
 * @returns {void}
 */
export default function validateModifier(modifier) {
    /**
     * Ensure the length attribute is proper type
     * and within acceptable values.
     */
    if (!modifier.length
        || (typeof (modifier.length) !== 'string'
            &amp;&amp; typeof (modifier.length) !== 'number')) {
        throw new Error(createMessage(E_errors.invalidAttributeType, [config.errorMessagePrefix, 'vM', '1', 'length', 'string or number']));
    }
    else {
        if (typeof (modifier.length) === 'string') {
            const length = parseInt(modifier.length);
            if (length > config.passwordLengthMax
                || length &lt; config.passwordLengthMin) {
                throw new Error(createMessage(E_errors.invalidAttributeType, [config.errorMessagePrefix, 'vM', '1', 'length', 'string or number']));
            }
        }
        else {
            if (modifier.length > config.passwordLengthMax
                || modifier.length &lt; config.passwordLengthMin) {
                throw new Error(createMessage(E_errors.outOfBoundsAttributeValue, [config.errorMessagePrefix, 'vM', '2', 'length']));
            }
        }
        // Check if the password will be long enough to contain all the attributes.
        const modifierCount = Object.keys(modifier)
            .filter((item) => {
            return L_useableAttributes.includes(item);
        })
            .length;
        if (modifierCount > modifier.length) {
            throw new Error(createMessage(E_errors.toManyAttributes, [config.errorMessagePrefix, 'vM', '3', `${modifier.length}`, `${modifierCount}`]));
        }
    }
    /**
     * If the 'white-space between' attribute is set,
     * and if the 'white-space between limit' attribute is not set,
     * throw an error.
     */
    if (modifier.w_between) {
        if (!modifier.w_between_limit) {
            throw new Error(createMessage(E_errors.whitespaceBetweenMissingLimit, [config.errorMessagePrefix,]));
        }
        /**
         * Ensure the 'white-space between limit' attribute is proper type
         * and within acceptable values.
         */
        if (typeof (modifier.w_between_limit) !== 'string'
            &amp;&amp; typeof (modifier.w_between_limit) !== 'number') {
            throw new Error(createMessage(E_errors.invalidAttributeType, [config.errorMessagePrefix, 'vM', '4', 'w_between_limit', 'string or number']));
        }
        else {
            if (typeof (modifier.w_between_limit) === 'string') {
                const w_between_limit = parseInt(modifier.w_between_limit);
                if (w_between_limit > config.whitespaceBetweenMax()
                    || w_between_limit &lt; config.whitespaceBetweenMin()) {
                    throw new Error(createMessage(E_errors.outOfBoundsAttributeValue, [config.errorMessagePrefix, 'vM', '5', 'w_between_limit']));
                }
            }
            else {
                if (modifier.w_between_limit > config.whitespaceBetweenMax()
                    || modifier.w_between_limit &lt; config.whitespaceBetweenMin()) {
                    throw new Error(createMessage(E_errors.outOfBoundsAttributeValue, [config.errorMessagePrefix, 'vM', '6', 'w_between_limit']));
                }
            }
        }
    }
    /**
     * Ensure the modifier contains at least one of these attributes.
     */
    if (!Object.keys(modifier)
        .some(function (array) {
        return L_requiredAttributes.includes(array);
    })) {
        throw new Error(createMessage(E_errors.missingRequiredAttributes, [config.errorMessagePrefix, 'vM', '7', L_requiredAttributes.toString()]));
    }
    /**
     * If the 'exclude characters' attributes is set,
     * ensure it is the proper type,
     * is not blank,
     * its length is within proper range,
     * and does not contain any whitespace.
     */
    if (modifier.excludeCharacters) {
        if (typeof (modifier.excludeCharacters) !== 'string') {
            throw new Error(createMessage(E_errors.invalidAttributeType, [config.errorMessagePrefix, 'vM', '8', 'excludeCharacters', 'string']));
        }
        if (!modifier.excludeCharacters.length
            &amp;&amp; modifier.excludeCharacters.length &lt;= 0) {
            throw new Error(createMessage(E_errors.outOfBoundsAttributeValue, [config.errorMessagePrefix, 'vM', '9', 'excludeCharacters']));
        }
        if (new RegExp('/[\s]/g').test(modifier.excludeCharacters)) {
            throw new Error(createMessage(E_errors.excludeCharactersContainedWhitespace, [config.errorMessagePrefix, 'vM', '10']));
        }
    }
}
</code></pre>
    </article>
</section>





</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-E_errors.html">E_errors</a></li><li><a href="module-L_allowedModifiers.html">L_allowedModifiers</a></li><li><a href="module-L_requiredAttributes.html">L_requiredAttributes</a></li><li><a href="module-L_useableAttributes.html">L_useableAttributes</a></li><li><a href="module-L_whitespaceAttributes.html">L_whitespaceAttributes</a></li><li><a href="module-characterCodeConstraints.html">characterCodeConstraints</a></li><li><a href="module-cleanModifier.html">cleanModifier</a></li><li><a href="module-config.html">config</a></li><li><a href="module-createMessage.html">createMessage</a></li><li><a href="module-createModifierList.html">createModifierList</a></li><li><a href="module-generateCharCode.html">generateCharCode</a></li><li><a href="module-shuffle.html">shuffle</a></li><li><a href="module-simplePass.html">simplePass</a></li><li><a href="module-validateModifier.html">validateModifier</a></li></ul><h3>Interfaces</h3><ul><li><a href="I_charCodeGenerationFlag.html">I_charCodeGenerationFlag</a></li><li><a href="I_charCodeOptions.html">I_charCodeOptions</a></li><li><a href="I_charCodeRequest.html">I_charCodeRequest</a></li><li><a href="I_passwordModifier.html">I_passwordModifier</a></li><li><a href="module-characterCodeConstraints-I_charCodeConstraintsAttributes.html">I_charCodeConstraintsAttributes</a></li></ul><h3>Other Resources</h3><ul><li><a href="tutorial-CODE_OF_CONDUCT.html">Code Of Conduct</a></li><li><a href="tutorial-CONTRIBUTING.html">Contributing</a></li><li><a href="tutorial-README.html">README</a></li><li><a href="tutorial-SECURITY.html">Security</a></li><li><a href="tutorial-development.html">Development</a></li><li><a href="tutorial-installation-and-examples.html">Installation & Examples</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
