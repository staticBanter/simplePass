<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="description"content="A JavaScript password generator"><meta name="theme-color"content="#636980"><!--Open Graph Protocol Meta Data--><meta property="og:title"content="simplePass | Source: functions/strengthChecker.js"><meta property="og:type"content="website"><meta property="og:url"content="https://staticbanter.github.io/simplePass/"><meta property="og:description"content="simplePass documentation page for Source: functions/strengthChecker.js"><meta property="og:locale"content="en_CA"><meta property="og:site_name"content="GitHub"><link rel="apple-touch-icon"href="../storage/icons/simplePass-Logo-1080.png"><link rel="manifest"href="../manifest.json"><link type="image/png"rel="icon"href="../storage/icons/simplePass-Logo-512.png"><title>simplePass Docs: Source: functions/strengthChecker.js</title><script src="scripts/prettify/prettify.js"></script><script src="scripts/prettify/lang-css.js"></script><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--><link type="text/css"rel="stylesheet"href="styles/prettify-tomorrow.css"><link type="text/css"rel="stylesheet"href="styles/jsdoc-default.css"></head><body><div id="main"><h1 class="page-title">Source: functions/strengthChecker.js</h1><section><article><pre class="prettyprint source linenums"><code>/**
* simplePass - A JavaScript password generator.
* Copyright (C) 2023  Jordan Vezina(staticBanter)
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program.  If not, see &lt;https://www.gnu.org/licenses/>.
*/
'use strict';
import calculateMaxPossibleCharacters from "./calculateMaxPossibleCharacters.js";
/**
 * @file
 * @module strengthChecker
 */
/**
 * A that provides various form of information about a password such as the:
 * - Bits of entropy calculated as ```E = l(log2(p))```; where:
 *  - *E* = Entropy of the password,
 *  - *l* = Length of the password,
 *  - *p* = Is the number of Possibilities (number of possible characters).
 * - Possible combinations for the password,
 * - Binary string representation of the password,
 * - Length of the binary string,
 * - Average bit length of each character.
 * @function strengthChecker
 * @param {string} password The password to check the strength of.
 * @param {strengthCheckerConstraints} constraints An [object]{@link module:strengthCheckerConstraints} representing constraints the password was created under.
 * @requires calculateMaxPossibleCharacters
 * @returns {strengthCheckedPassword} An [object]{@link module:strengthCheckedPassword} containing the strength checked password, its strength score, and the bit entropy of the password.
 */
export default function strengthChecker(password, constraints, compressions) {
    const numberOfCharacters = calculateMaxPossibleCharacters({
        characterSets: constraints.characterSets.used
            .filter((item) => {
            return constraints.characterSets.available.includes(item);
        }),
        excludeCharacters: constraints.excludeCharacters
    });
    const binaryStringDelimiter = ' ';
    const binaryString = password.split('')
        .map((char) => {
        const bin = char.charCodeAt(0).toString(2);
        return ((Array((Math.ceil(bin.length / 8) * 8)
            - bin.length + 1)
            .join("0"))
            + bin);
    })
        .join(binaryStringDelimiter);
    let averageBitLength = 0;
    binaryString.split(binaryStringDelimiter)
        .forEach((byte) => {
        averageBitLength += byte.length;
    });
    let uniqueCharacters = '';
    password.split('').forEach(element => {
        if (!uniqueCharacters.includes(element)) {
            uniqueCharacters += element;
        }
    });
    if (compressions) {
        const compressionResponses = [];
        for (let i = 0; i &lt; compressions.length; i++) {
            const byteArray = new TextEncoder().encode(password);
            const cs = new CompressionStream(compressions[i]);
            const writer = cs.writable.getWriter();
            writer.write(byteArray);
            writer.close();
            compressionResponses.push(new Response(cs.readable).arrayBuffer());
        }
        if (compressions.length) {
            return Promise.all(compressionResponses)
                .then((compressionBuffers) => {
                const compressionStats = {};
                let averageCompression = 0;
                compressions.forEach((compression, index) => {
                    compressionStats[compression] = compressionBuffers[index].byteLength;
                    averageCompression += compressionBuffers[index].byteLength;
                });
                compressionStats['average'] = (averageCompression / compressionBuffers.length);
                return {
                    password: password,
                    entropy: (password.length * Math.log2(numberOfCharacters)),
                    possibleCombinations: (numberOfCharacters ** password.length),
                    binaryStringLength: binaryString.replaceAll(binaryStringDelimiter, '').length,
                    binaryString: binaryString,
                    averageCharacterBitLength: (averageBitLength / password.length),
                    uniqueCharactersPercentage: ((uniqueCharacters.length / password.length) * 100),
                    compressionStats: compressionStats
                };
            });
        }
    }
    return {
        password: password,
        entropy: (password.length * Math.log2(numberOfCharacters)),
        possibleCombinations: (numberOfCharacters ** password.length),
        binaryStringLength: binaryString.replaceAll(binaryStringDelimiter, '').length,
        binaryString: binaryString,
        averageCharacterBitLength: (averageBitLength / password.length),
        uniqueCharactersPercentage: ((uniqueCharacters.length / password.length) * 100),
    };
}
</code></pre></article></section></div><nav><a href="../index.html">simplePass Program</a><a href="../EXAMPLES-AND-INTEGRATION.html">Examples & Integration</a><h3><a href="index.html">README</a></h3><h3>Modules</h3><ul><li><a href="module-allowedModifiers.html">allowedModifiers</a></li><li><a href="module-calculateMaxPossibleCharacters.html">calculateMaxPossibleCharacters</a></li><li><a href="module-characterCodeConstraints.html">characterCodeConstraints</a></li><li><a href="module-cleanModifier.html">cleanModifier</a></li><li><a href="module-config.html">config</a></li><li><a href="module-createMessage.html">createMessage</a></li><li><a href="module-ensureRepeatingCharacters.html">ensureRepeatingCharacters</a></li><li><a href="module-errors.html">errors</a></li><li><a href="module-generateCharCode.html">generateCharCode</a></li><li><a href="module-initializer.html">initializer</a></li><li><a href="module-matchCharacterSetConstraint.html">matchCharacterSetConstraint</a></li><li><a href="module-messageHandler.html">messageHandler</a></li><li><a href="module-passwordPreConfigs.html">passwordPreConfigs</a></li><li><a href="module-range.html">range</a></li><li><a href="module-shuffle.html">shuffle</a></li><li><a href="module-simplePass.html">simplePass</a></li><li><a href="module-strengthChecker.html">strengthChecker</a></li><li><a href="module-uniqueCharacterFilter.html">uniqueCharacterFilter</a></li><li><a href="module-validateModifier.html">validateModifier</a></li><li><a href="module-whitespaceAttributes.html">whitespaceAttributes</a></li></ul><h3>Interfaces</h3><ul><li><a href="charCodeGenerationFlag.html">charCodeGenerationFlag</a></li><li><a href="charCodeOptions.html">charCodeOptions</a></li><li><a href="charCodeRequest.html">charCodeRequest</a></li><li><a href="characterCodeConstraintsAttributes.html">characterCodeConstraintsAttributes</a></li><li><a href="characterSetObject.html">characterSetObject</a></li><li><a href="ensureRepeatingCharacterOptions.html">ensureRepeatingCharacterOptions</a></li><li><a href="messageBoxObject.html">messageBoxObject</a></li><li><a href="messageObject.html">messageObject</a></li><li><a href="messageTypes.html">messageTypes</a></li><li><a href="module-config-Messages.html">Messages</a></li><li><a href="module-config-PasswordConstraints.html">PasswordConstraints</a></li><li><a href="module-config-SimplePassConfig.html">SimplePassConfig</a></li><li><a href="module-config-configHTMLElement.html">configHTMLElement</a></li><li><a href="passwordModifier.html">passwordModifier</a></li><li><a href="repeatingCharacterOptionsPreservations.html">repeatingCharacterOptionsPreservations</a></li><li><a href="strengthCheckCompression.html">strengthCheckCompression</a></li><li><a href="strengthCheckTargets.html">strengthCheckTargets</a></li><li><a href="strengthCheckedPassword.html">strengthCheckedPassword</a></li><li><a href="strengthCheckerConstraints.html">strengthCheckerConstraints</a></li></ul><h3>Other Resources</h3><ul><li><a href="CODE_OF_CONDUCT.html">Code Of Conduct</a></li><li><a href="CONTRIBUTING.html">Contributing</a></li><li><a href="DEVELOPMENT.html">DEVELOPMENT</a></li><li><a href="SECURITY.html">Security</a></li></ul></nav><br class="clear"><footer>Documentation generated by<a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a></footer><script>prettyPrint();</script><script src="scripts/linenumber.js"></script></body></html>