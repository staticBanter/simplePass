/*!
 * 
 * simplePass - A Javascript password generator..
 * Copyright (C) 2023  Jordan Vezina (staticBanter)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 */var e={d:(t,s)=>{for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{A:()=>x});const s=["whitespaceBeginning","whitespaceEnd","whitespaceBetween","max_whitespaceBetween","required_whitespaceEnd","required_whitespaceBeginning"];function a(e,t,s){const a=[],n=s?.increment??1;for(;e<t+n;){if(e<=t)if(s){if(s.exclude&&s.exclude.includes(e)){e+=n;continue}s.singles?a.push([e]):a.push(e)}else a.push(e);e+=n}return s?.forceInclusiveEnd&&!a.includes(t)&&(s.singles?a.push([t]):a.push(t)),a}const n={lowercase:{min:97,max:122},uppercase:{min:65,max:90},numbers:{min:48,max:57},punctuation:{min:33,max:126,range:[[33,47],[58,64],[91,96],[123,126]]},whitespace:{min:32},lowercase_supplement:{min:223,max:255,range:[[233,246],[248,255]]},uppercase_supplement:{min:192,max:222,range:[[192,214],[216,222]]},symbols_supplement:{min:161,max:247,range:[[161,191],[215],[247]]},lowercase_extended_a:{min:257,max:383,range:a(257,312,{increment:2,exclude:[306,307],forceInclusiveEnd:!0}).concat(a(314,329,{increment:2,forceInclusiveEnd:!0})).concat(a(331,375,{increment:2,exclude:[338,339]})).concat(a(378,383,{increment:2,forceInclusiveEnd:!0})).map((e=>[e]))},uppercase_extended_a:{min:256,max:382,range:a(256,310,{increment:2,exclude:[306,307]}).concat(a(313,327,{increment:2})).concat(a(330,374,{increment:2,exclude:[338,339]})).concat([376]).concat(a(377,381,{increment:2})).map((e=>[e]))},ligature_extended_a:{min:306,max:339,range:[[306],[307],[338],[339]]},lowercase_extended_b:{min:384,max:591,range:[[384],[387],[389],[392],[396,397],[402],[405],[409,411],[414],[417],[419],[421],[427],[432],[436],[438],[441,442],[445],[454],[457],[460],[496],[499],[501],[572],[589],[591],[578],[563,569],[575,576],[585],[587],[583]].concat(a(462,476,{increment:2})).concat(a(479,495,{increment:2})).concat(a(505,561,{increment:2}))},uppercase_extended_b:{min:385,max:590,range:[[444]].concat(a(385,408,{exclude:[387,389,392,396,397,402,405],singles:!0})).concat(a(412,440,{exclude:[414,417,419,421,422,424,426,427,429,432,436,438],singles:!0})).concat(a(452,458,{exclude:[453,454,456,459],singles:!0})).concat(a(461,475,{increment:2,singles:!0})).concat(a(478,494,{increment:2,singles:!0})).concat(a(497,504,{exclude:[498,499,501],singles:!0})).concat(a(506,562,{increment:2,singles:!0})).concat(a(570,590,{exclude:[572,575,576,578,583,585,587,589],singles:!0}))},mixedcase_extended_b:{min:453,max:498,range:[[453],[456],[459],[498]]},insensitivecase_extended_b:{min:422,max:451,range:[[422],[426],[443],[446,451]]},lowercase_ipa_extension:{min:592,max:683,range:[[592,659],[665,672],[675,683]]},uppercase_ipa_extension:{min:660,max:685,range:[[660,664],[673,674],[684,685]]},character_modifier_letters:{min:688,max:739,range:[[688,696],[737,739]]},symbol_modifier_letters:{min:697,max:767,range:[[697,736],[740,767]]},lowercase_greek_coptic:{min:881,max:1019,range:[[881],[883],[887],[912],[940,974],[1016],[1019]].concat(a(985,107,{increment:2,singles:!0}))},uppercase_greek_coptic:{min:880,max:1018,range:[[880],[882],[886],[902],[904,906],[908],[910,911],[913,929],[931,939],[1015],[1018]].concat(a(994,1004,{increment:2,singles:!0}))},insensitivecase_greek_coptic:{min:984,max:1011,range:[[1011]].concat(a(984,992,{increment:2,singles:!0}))},symbol_greek_coptic:{min:884,max:1020,range:[[884,885],[890,894],[900,901],[903],[975,983],[988],[1008,1014],[1020,1023]]},lowercase_cyrillic:{min:1072,max:1279,range:[[1072,1119]].concat(a(1121,1153,{increment:2,singles:!0})).concat(a(1163,1215,{increment:2,exclude:[1189,1205],singles:!0})).concat(a(1218,1230,{increment:2,singles:!0})).concat(a(1231,1279,{increment:2,exclude:[1237],singles:!0}))},uppercase_cyrillic:{min:1024,max:1278,range:[[1024,1071]].concat(a(1120,1214,{increment:2,exclude:[1154,1156,1158,1160,1188,1204],singles:!0})).concat(a(1217,1229,{increment:2,singles:!0})).concat(a(1232,1278,{increment:2,exclude:[1236],singles:!0}))},symbols_cyrillic:{min:1154,max:1237,range:[[1154],[1188,1189],[1204,1205],[1236,1237]]},lowercase_cyrillic_supplement:{min:1281,max:1319,range:a(1281,1319,{increment:2,singles:!0})},uppercase_cyrillic_supplement:{min:1280,max:1319,range:a(1280,1319,{increment:2,singles:!0})},misc_cyrillic_supplement:{min:1320,max:1327},general_punctuation:{min:8208,max:8286,range:[[8208,8231],[8240,8286]]},currency_symbols:{min:8352,max:8383,range:[[8352,8371],[8373,8383]]},misc_technical:{min:8960,max:9215},box_drawings:{min:9472,max:9599},block_elements:{min:9600,max:9631},misc_symbols:{min:9728,max:9983,range:[[9728,9897],[9899,9983]]},dingbats:{min:9984,max:10175}},r={invalidModifier:"Invalid Modifier. The password modifier must be a valid JavaScript Object or JavaScript 'FormData' Object.",toManyAttributes:"To Many Attributes. The requested password may only contain ~ attributes, ~ attributes were selected.",nonGenerableCharacterType:"Non Generable Character Type. Attempted to generate a character of type ~",invalidAttributeType:"InvalidAttribute Type. Attribute ~ is supposed to be of type ~",outOfBoundsAttributeValue:"Out Of Bounds Attribute Type. Attribute type ~ is out of its value bounds.",missingRequiredAttributes:"Missing Required Attribute. The attribute '~' requires attribute '~' to be set before it can be used.",missingRequiredModifier:"Missing Required Attributes. The Password Modifier must contain one of the following attributes ~.",excludeCharactersContainedWhitespace:"'Exclude Characters' contained whitespace"},i={default:{length:22,numbers:!0,lowercase:!0,uppercase:!0,punctuation:!0},fourDigitPin:{numbers:!0,length:4},defaultSupplement1:{length:22,numbers:!0,symbols_supplement:!0,lowercase_supplement:!0,uppercase_supplement:!0},bios:{length:20,lowercase:!0,uppercase:!0,numbers:!0},extreme:{length:256,numbers:!0,lowercase:!0,uppercase:!0,punctuation:!0,lowercase_supplement:!0,uppercase_supplement:!0,symbols_supplement:!0,max_repeatingCharacter:Math.floor(9*Math.random()+5),whitespaceBetween:!0,max_whitespaceBetween:Math.floor(9*Math.random()+2)}},c=["length","excludeCharacters","uniqueCharacters","repeatingCharacter","max_repeatingCharacter","customRepeatingCharacters","preConfig"],o={passwordConstraints:{min_length:3,max_length:256,min_excludeCharactersLength:0,max_excludeCharactersLength:256,min_repeatingCharactersLength:0,max_repeatingCharactersLength:50,max_whitespaceCharactersOffset:4,max_whitespaceBetween:function(){const e=this.max_length-this.max_whitespaceCharactersOffset;return e>=1?e:0},min_whitespaceBetween:function(){return this.max_length-this.max_whitespaceCharactersOffset>=1?1:0}},defaultPasswordModifier:{length:22,lowercase:!0,uppercase:!0,numbers:!0,punctuation:!0},messages:{prefix:"ERROR.simplePass-~.~:",templateMarker:"~",messageBoard:".simplePass_messageBoard",messageBoxes:".simplePass_messageBox",messageBackdrop:".simplePass_messageBackdrop",clearConsole:!1},elements:{passwordTarget:".simplePass_passwordTarget",passwordContainer:".simplePass_passwordContainer",actions:{generate:".simplePass_generator",copy:".simplePass_copier",form:"#simplePass_form"}},strengthCheck:{entropyTarget:".simplePass_entropyTarget",possibleCombinationsTarget:".simplePass_possibleCombinationsTarget",binaryStringTarget:".simplePass_binaryStringTarget",binaryStringLengthTarget:".simplePass_binaryStringLengthTarget",averageCharacterBitLengthTarget:".simplePass_averageCharacterBitLengthTarget",uniqueCharactersPercentageTarget:".simplePass_uniqueCharactersPercentageTarget",compression:{gzipTarget:".simplePass_gzipCompressionTarget",deflateTarget:".simplePass_deflateCompressionTarget","deflate-rawTarget":".simplePass_deflate-rawCompressionTarget",averageTarget:".simplePass_averageCompressionTarget"}}};function l(e){let t,s=e.length;for(;0!=s;)t=Math.floor(Math.random()*s),s--,[e[s],e[t]]=[e[t],e[s]];return e}function m(e,t){function s(e){const t=[];return e.split("").forEach((e=>{t.includes(e)||t.push(e)})),t.join("")}let a=e.slice(0,1),n=e.slice(1,e.length-1),r=e.slice(e.length-1,e.length);if(t.customCharacterSet){const s=[];n.split("").forEach((e=>{s.push(e)})),"string"==typeof t.customCharacterSet?t.customCharacterSet.split("").forEach((e=>{s.push(e),s.push(e)})):t.customCharacterSet.forEach((e=>{let t=parseInt(e[1]);for(;t--;)s.push(e[0])})),t.preservations?.beginning||(s.push(a),a=""),t.preservations?.end||(s.push(r),r=""),e=a+l(s).join("")+r}else if(t.repeatingSetCount&&t.repeatingSetCount>1){let i=l(e.split(""));i=s(i.join("")).split(""),n=s(n);for(let e=0;e<t.repeatingSetCount&&i[e];e++)n+=i[e];e=a+l(n.split("")).join("")+r}else n+=l(e.split(""))[0],e=a+l(n.split("")).join("")+r;return e}function p(e,t,s=self.crypto){let a=s.getRandomValues(new Uint8Array(1))[0];if(e.charCodeOptions?.excludeCharacters&&e.charCodeOptions.excludeCharacters.includes(String.fromCharCode(a)))return p(e,t,s);t&&(t?.beginning&&e.charCodeOptions?.whitespaceOptions?.includes("whitespaceBeginning")&&32===a&&(e.charType="whitespace"),t?.end&&e.charCodeOptions?.whitespaceOptions?.includes("whitespaceEnd")&&32===a&&(e.charType="whitespace"));const i=n[e.charType];if(!i)throw{errorKey:r.nonGenerableCharacterType,replacements:["gCC","1",e.charType]};const c=function(e,t){if(t.min>255&&(e+=t.min),!t.max&&!t.range&&e===t.min)return e;if(t.range){if(t.min&&t.max&&e>=t.min&&e<=t.max){if(e===t.min||e===t.max)return e;for(let s=0;s<t.range.length;s++){if(t.range[s][0]&&t.range[s][1]&&e>=t.range[s][0]&&e<=t.range[s][1])return e;if(t.range[s][0]&&e===t.range[s][0])return e}}}else if(t.min&&t.max&&e>=t.min&&e<=t.max)return e;return!1}(a,i);return c||p(e,t,s)}function g(e){let t=document.createElement("DIV"),s="SP_MESSAGE",a="ERROR";t.classList.add(o.messages.messageBoxes?.substring(1)??"simplePass_messageBox");const n=document.createElement("DIV");t.appendChild(n);const r=document.createElement("BUTTON");r.title="Close",r.innerText="X";let i=document.createElement("P"),c=null;if("object"==typeof e){if(e.level&&(a=e.level.toUpperCase(),s=a),e.title&&(s=e.title.replaceAll(" ","_")),e.type&&(t.dataset.messageType=e.type,"overlay"===e.type.toLowerCase()))c=document.createElement("DIV"),c.classList.add(o.messages.messageBackdrop?.substring(1)??"simplePass_messageBackdrop");"string"==typeof e.message?i.innerText=e.message:(i=document.createElement("UL"),e.message.forEach((e=>{const t=document.createElement("LI");t.innerText=e,i.appendChild(t)})))}else i.innerText=e;t.dataset.title=s,t.dataset.messageLevel=a;const l=document.createElement("STRONG");return l.innerText=s,n.appendChild(l),n.appendChild(r),r.addEventListener("click",(e=>{e.preventDefault(),t.remove()})),t.appendChild(i),c&&(c.appendChild(t),t=c,t.setAttribute("style",`\n            height: ${document.documentElement.scrollHeight}px;\n            width: ${document.documentElement.scrollWidth}px;\n        `),window.addEventListener("resize",(()=>{t.setAttribute("style","\n                height: 0px;\n                width: 0px;\n            "),t.setAttribute("style",`\n                height: ${document.documentElement.scrollHeight}px;\n                width: ${document.documentElement.scrollWidth}px;\n            `)}))),t}function d(e,t={consoleMessage:!0,level:"ERROR"},s=o){if(!s.messages)return;if(s.messages.prefix||(s.messages.prefix=o.messages.prefix),s.messages.templateMarker||(s.messages.templateMarker=o.messages.templateMarker),"CLEAR"===e)return"object"==typeof t.consoleMessage&&t.consoleMessage.clear&&console.clear(),void(t.htmlMessage?.clear&&t.htmlMessage.messageBoard&&t.htmlMessage.messageBoard.querySelectorAll(".sp_messageBox").forEach((e=>{e.remove()})));let a;if("object"==typeof e&&(e.title&&(a=e.title.replace(" ","_")),e=e.templateMessages&&e.templateMessages.templates&&e.templateMessages.replacements&&e.templateMessages.replacements.length&&e.templateMessages.replacements.length>=1?function(e,t,s=o){let a=0;for(e=`${s.messages.prefix} ${e}`;e.includes(s.messages.templateMarker);){if(t[a]===s.messages.templateMarker)throw new Error(`${s.messages.prefix}-cM_E.1: A 'Message Replacement', "${t[a]}", contained a 'Message Marker', "${s.messages.templateMarker}".`);e=e.replace(s.messages.templateMarker,t[a++]??t[t.length-1])}return e}(e.templateMessages.templates[e.messageKey],e.templateMessages.replacements,s):e.messageKey),!t.consoleMessage&&!t.htmlMessage){const s="sP-eH_E.4: Missing Message Type. A Message Of Unknown Type Was Created:";return console.warn(s),void document.body.appendChild(g({message:[s,e],title:"sP-eH_E.4: Missing Message Type.",type:"overlay",level:t.level}))}switch(t.htmlMessage&&t.htmlMessage.messageBoard.appendChild(g({message:e,title:a,level:t.level})),t.level?.toLocaleLowerCase()){case"info":console.info(e);break;case"warning":console.warn(e);break;case"log":console.log(e);break;default:throw new Error(e)}}function h(e,t){e instanceof HTMLInputElement?e.value=t:e.innerText=t}function u(e){return e instanceof HTMLInputElement?e.value:e.innerText}function f(e,t,s){"string"==typeof t?h(e,t):(h(e,t.password),s&&C(t,s))}function C(e,t){Object.entries(t).forEach((([t,s])=>{s&&(t=t.replace("Target",""),e.compressionStats&&Object.keys(e.compressionStats).includes(t)&&e.compressionStats[t]?h(s,e.compressionStats[t]):Object.keys(e).includes(t)&&h(s,e[t]))}))}function y(e,t,s){const a=function(e){let t=0,s=!1;return e.characterSets.forEach((e=>{if("whitespace"===e){if(s)return;return t++,void(s=!0)}const a=n[e];a&&(a.range?a.range.forEach((e=>{e[0]&&e[1]?t+=e[1]-e[0]+1:e[0]&&t++})):!a.range&&a.min&&a.max?t+=a.max-a.min+1:a.range||a.max||t++)})),e.excludeCharacters&&e.excludeCharacters.length>0&&(t-=function(e){let t="";for(let s=0;s<e.length;s++)t.includes(e[s])||(t+=e[s]);return t}(e.excludeCharacters).length),t}({characterSets:t.characterSets.used.filter((e=>t.characterSets.available.includes(e))),excludeCharacters:t.excludeCharacters}),r=" ",i=e.split("").map((e=>{const t=e.charCodeAt(0).toString(2);return Array(8*Math.ceil(t.length/8)-t.length+1).join("0")+t})).join(r);let c=0;i.split(r).forEach((e=>{c+=e.length}));let o="";if(e.split("").forEach((e=>{o.includes(e)||(o+=e)})),s){const t=[];for(let a=0;a<s.length;a++){const n=(new TextEncoder).encode(e),r=new CompressionStream(s[a]),i=r.writable.getWriter();i.write(n),i.close(),t.push(new Response(r.readable).arrayBuffer())}if(s.length)return Promise.all(t).then((t=>{const n={};let l=0;return s.forEach(((e,s)=>{n[e]=t[s].byteLength,l+=t[s].byteLength})),n.average=l/t.length,{password:e,entropy:e.length*Math.log2(a),possibleCombinations:a**e.length,binaryStringLength:i.replaceAll(r,"").length,binaryString:i,averageCharacterBitLength:c/e.length,uniqueCharactersPercentage:o.length/e.length*100,compressionStats:n}}))}return{password:e,entropy:e.length*Math.log2(a),possibleCombinations:a**e.length,binaryStringLength:i.replaceAll(r,"").length,binaryString:i,averageCharacterBitLength:c/e.length,uniqueCharactersPercentage:o.length/e.length*100}}const w={length:e=>"number"==typeof(e=parseInt(e))&&e%1==0&&e>=o.passwordConstraints.min_length&&e<=o.passwordConstraints.max_length,excludeCharacters:e=>"string"==typeof e&&!new RegExp(/[\s]/g).test(e)&&e.length>=o.passwordConstraints.min_excludeCharactersLength&&e.length<=o.passwordConstraints.max_excludeCharactersLength,uniqueCharacters:e=>!!e,repeatingCharacter:e=>!!e,max_repeatingCharacter:e=>"number"==typeof(e=parseInt(e))&&e%1==0&&e>=o.passwordConstraints.min_repeatingCharactersLength&&e<=o.passwordConstraints.max_repeatingCharactersLength,customRepeatingCharacters:e=>{if(Array.isArray(e)){if(!e.length)return!1;for(let t=0;t<e.length;t++)if(!Array.isArray(e[t])||e[t].length>1||"string"==typeof e[t][0])return!1}else if("string"==typeof e)return e.length&&e.length>=o.passwordConstraints.min_repeatingCharactersLength&&e.length<=o.passwordConstraints.max_repeatingCharactersLength;return!1},preConfig:e=>"string"==typeof e&&Object.keys(i).includes(e),whitespaceBeginning:e=>!!e,required_whitespaceBeginning:e=>!!e,whitespaceEnd:e=>!!e,required_whitespaceEnd:e=>!!e,whitespaceBetween:e=>!!e,max_whitespaceBetween:e=>"number"==typeof(e=parseInt(e))&&e%1==0&&e>=o.passwordConstraints.min_whitespaceBetween()&&e<=o.passwordConstraints.max_whitespaceBetween(),lowercase:e=>!!e,uppercase:e=>!!e,numbers:e=>!!e,punctuation:e=>!!e,lowercase_supplement:e=>!!e,uppercase_supplement:e=>!!e,symbols_supplement:e=>!!e,lowercase_extended_a:e=>!!e,uppercase_extended_a:e=>!!e,ligature_extended_a:e=>!!e,lowercase_extended_b:e=>!!e,uppercase_extended_b:e=>!!e,mixedcase_extended_b:e=>!!e,insensitivecase_extended_b:e=>!!e,lowercase_ipa_extension:e=>!!e,uppercase_ipa_extension:e=>!!e,character_modifier_letters:e=>!!e,symbol_modifier_letters:e=>!!e,lowercase_greek_coptic:e=>!!e,uppercase_greek_coptic:e=>!!e,insensitivecase_greek_coptic:e=>!!e,symbol_greek_coptic:e=>!!e,lowercase_cyrillic:e=>!!e,uppercase_cyrillic:e=>!!e,symbols_cyrillic:e=>!!e,lowercase_cyrillic_supplement:e=>!!e,uppercase_cyrillic_supplement:e=>!!e,misc_cyrillic_supplement:e=>!!e,general_punctuation:e=>!!e,currency_symbols:e=>!!e,misc_technical:e=>!!e,box_drawings:e=>!!e,block_elements:e=>!!e,misc_symbols:e=>!!e,dingbats:e=>!!e};function x(e=o.defaultPasswordModifier,t=o){let a=null;t.messages&&t.messages.messageBoard&&(a=document.body.querySelector(t.messages.messageBoard)),d("CLEAR",{htmlMessage:a?{messageBoard:a,clear:!0}:void 0,consoleMessage:{clear:t.messages?.clearConsole},level:"CLEAR"},t),e&&"object"==typeof e||d({messageKey:"invalidModifier",templateMessages:{replacements:["M","1"],templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t),e=function(e){const t={length:o.defaultPasswordModifier.length};function a([e,a]){c.concat(Object.keys(n)).concat(s).includes(e)&&(!a||"string"!=typeof a&&"number"!=typeof a&&"boolean"!=typeof a||(t[e]=a))}if(e instanceof FormData)for(let[t,s]of e.entries())a([t,s]);else for(const[t,s]of Object.entries(e))a([t,s]);return t}(e);try{!function(e){Object.entries(w).forEach((([t,s])=>{if(e[t]&&!s(e[t]))throw new Error(`Invalid value for password modifier attribute ${t}`)}));let t=Object.keys(e).filter((e=>Object.keys(n).includes(e))).length;if(e.repeatingCharacter)if(e.customRepeatingCharacters){if("string"!=typeof e.customRepeatingCharacters)throw{errorKey:"invalidAttributeType",replacements:["vM","15","customRepeatingCharacters","string"]};if(e.customRepeatingCharacters=e.customRepeatingCharacters.trim(),e.customRepeatingCharacters.includes(" ")){const s=[];e.customRepeatingCharacters.split(" ").forEach((e=>{if(e.includes("\\")){const t=e.slice(1,2),a=(e=e.replace(t,"")).split(":");if(a.length>2)throw new Error('Custom Repeating Characters contain more than one ":" (colon) literal.');s.push([t,a[1]])}else{let t=e.split(":");if(t.length>2)throw new Error('Custom Repeating Characters contain more than one ":" (colon) literal.');s.push([t[0],t[1]])}})),e.customRepeatingCharacters=s,e.customRepeatingCharacters.forEach((e=>{(!e[1]||parseInt(e[1])<=1)&&(e[1]="2"),t+=parseInt(e[1])}))}else if(e.customRepeatingCharacters.includes(":")){const s=[];if(e.customRepeatingCharacters.includes("\\")){const t=e.customRepeatingCharacters.slice(1,2);e.customRepeatingCharacters=e.customRepeatingCharacters.replace(t,"");const a=e.customRepeatingCharacters.split(":");if(a.length>2)throw new Error('Custom Repeating Characters contain more than one ":" (colon) literal.');s.push([t,a[1]])}else{const t=e.customRepeatingCharacters.split(":");if(t.length>2)throw new Error('Custom Character Repeats contained an unescaped ":" (colon).');s.push([t[0],t[1]])}e.customRepeatingCharacters=s,e.customRepeatingCharacters.forEach((e=>{(!e[1]||parseInt(e[1])<=1)&&(e[1]="2"),t+=parseInt(e[1])}))}else t+=2*e.customRepeatingCharacters.length}else if(e.max_repeatingCharacter){if("number"!=typeof e.max_repeatingCharacter&&"string"!=typeof e.max_repeatingCharacter)throw{errorKey:"invalidAttributeType",replacements:["vM","13","max_repeatingCharacter","number or string"]};if("string"==typeof e.max_repeatingCharacter&&(e.max_repeatingCharacter=parseInt(e.max_repeatingCharacter)),e.max_repeatingCharacter<1||e.max_repeatingCharacter>100)throw{errorKey:"outOfBoundsAttributeValue",replacements:["vM","14","max_repeatingCharacter"]};if(e.length<2*e.max_repeatingCharacter)throw{errorKey:"The password can not contain the requested amount of repeating characters."};t+=e.max_repeatingCharacter}else t++;if(!Object.keys(e).some((function(e){return Object.keys(n).includes(e)})))throw{errorKey:"missingRequiredAttributes",replacements:["vM","7",Object.keys(n).toString()]};if(e.customRepeatingCharacters){if(t-1>e.length)throw{errorKey:"toManyAttributes",replacements:["vM","3",`${e.length}`,`${t}`]}}else if(t>e.length)throw{errorKey:"toManyAttributes",replacements:["vM","3",`${e.length}`,`${t}`]}}(e)}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}let g="",h="",u=!1,f=!1;if(t.defaultPasswordModifier||(t.defaultPasswordModifier=Object.assign(o.defaultPasswordModifier,t.defaultPasswordModifier)),t.passwordConstraints||(t.passwordConstraints=Object.assign(o.passwordConstraints,t.defaultPasswordModifier)),e.preConfig){const t=i[e.preConfig];e={length:e.length},t&&Object.assign(e,t)}const C=Object.keys(e).filter((e=>Object.keys(n).includes(e))),x=Object.keys(e).filter((e=>s.includes(e)));let _=e.length-2;if(e.uniqueCharacters&&(e.repeatingCharacter||e.whitespaceBeginning||e.whitespaceEnd||e.whitespaceEnd||e.required_whitespaceEnd||e.required_whitespaceBeginning||e.whitespaceBetween||e.max_whitespaceBetween||e.preConfig)&&d("ERROR.simplePass-M_E.2: Unique modifier was set with clashing modifiers."),e.repeatingCharacter&&(e.customRepeatingCharacters?("string"!=typeof e.customRepeatingCharacters?e.customRepeatingCharacters.forEach((e=>{_-=parseInt(e[1])})):_-=2*e.customRepeatingCharacters.length,e.max_repeatingCharacter&&(_-=e.max_repeatingCharacter)):e.max_repeatingCharacter?_-=e.max_repeatingCharacter:_--),e.whitespaceBetween){const s=e.max_whitespaceBetween??1;e.length-s<C.length&&d({messageKey:"ERROR: The password length can not contain the selected amount of characters"},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t),_-=s}if(_<=-1&&d({messageKey:"ERROR: The password length can not contain the selected amount of characters"},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t),C.length>1){let s=[];if(s=s.concat(l(C)),e.whitespaceBeginning&&e.required_whitespaceBeginning)g+=" ",u=!0;else{try{g+=String.fromCharCode(p({charType:s[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{beginning:!0},t.cryptoModule))}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}s.shift()}for(;h.length<_;){s.length||(s=s.concat(l(C)));try{const a=String.fromCharCode(p({charType:s[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},void 0,t.cryptoModule));if(e.uniqueCharacters&&(g.includes(a)||h.includes(a)))continue;h+=a}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}s.shift()}if(e.whitespaceBetween)if(e.max_whitespaceBetween&&e.max_whitespaceBetween>1)for(;e.max_whitespaceBetween--;)h+=" ";else h+=" ";if(g+=l(h.split("")).join(""),e.whitespaceEnd&&e.required_whitespaceEnd)g+=" ",f=!0;else{s.length||(s=s.concat(l(C)));try{let a=String.fromCharCode(p({charType:s[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{end:!0},t.cryptoModule));if(e.uniqueCharacters&&g.includes(a))for(;g.includes(a);)a=String.fromCharCode(p({charType:s[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{end:!0},t.cryptoModule));g+=a}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}}if(e.repeatingCharacter&&(g=m(g,{repeatingSetCount:e.max_repeatingCharacter,customCharacterSet:e.customRepeatingCharacters,preservations:{beginning:u,end:f}}),g.length<e.length)){let n=g.slice(0,1),i=g.slice(1,g.length-1),c=g.slice(g.length-1,g.length);for(;i.length<e.length-2;){s.length||(s=s.concat(l(C)));try{const a=String.fromCharCode(p({charType:s[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},void 0,t.cryptoModule));i+=a,i.length+1<=e.length-2&&(i+=a)}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}}g=n+l(i.split("")).join("")+c}}else{if(e.whitespaceBeginning&&e.required_whitespaceBeginning)g+=" ",u=!0;else try{g+=String.fromCharCode(p({charType:C[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{beginning:!0},t.cryptoModule))}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}for(;h.length<_;)try{const s=String.fromCharCode(p({charType:C[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},void 0,t.cryptoModule));if(e.uniqueCharacters&&(g.includes(s)||h.includes(s)))continue;h+=s}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}if(e.whitespaceBetween)if(e.max_whitespaceBetween&&e.max_whitespaceBetween>1)for(;e.max_whitespaceBetween--;)h+=" ";else h+=" ";if(g+=l(h.split("")).join(""),e.whitespaceEnd&&e.required_whitespaceEnd)g+=" ",f=!0;else try{let s=String.fromCharCode(p({charType:C[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{end:!0},t.cryptoModule));if(e.uniqueCharacters&&g.includes(s))for(;g.includes(s);)s=String.fromCharCode(p({charType:C[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},{end:!0},t.cryptoModule));g+=s}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}if(e.repeatingCharacter&&(g=m(g,{repeatingSetCount:e.max_repeatingCharacter,customCharacterSet:e.customRepeatingCharacters,preservations:{beginning:u,end:f}}),g.length<e.length)){let s=g.slice(0,1),n=g.slice(1,g.length-1),i=g.slice(g.length-1,g.length);for(;n.length<e.length-2;)try{const s=String.fromCharCode(p({charType:C[0],charCodeOptions:{whitespaceOptions:x,excludeCharacters:e.excludeCharacters}},void 0,t.cryptoModule));n+=s,n.length+1<=e.length-2&&(n+=s)}catch(e){e.message?d({messageKey:`${e.name??"Internal Error"}: ${e.message}`},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t):d({messageKey:e.errorKey,templateMessages:{replacements:e.replacements,templates:r}},{htmlMessage:a?{messageBoard:a}:void 0,consoleMessage:!0,level:"ERROR"},t)}g=s+l(n.split("")).join("")+i}}if(t.strengthCheck){if("object"==typeof t.strengthCheck&&t.strengthCheck.compression){const s=Object.keys(t.strengthCheck.compression).map((e=>e.replace("Target",""))).filter((e=>["gzip","deflate","deflate-raw"].includes(e)));return y(g,{characterSets:{used:Object.keys(e),available:Object.keys(n)},excludeCharacters:e.excludeCharacters,min_length:t.passwordConstraints.min_length,max_length:t.passwordConstraints.max_length},s)}return y(g,{characterSets:{used:Object.keys(e),available:Object.keys(n)},excludeCharacters:e.excludeCharacters,min_length:t.passwordConstraints.min_length,max_length:t.passwordConstraints.max_length})}return g}x.init=function(e=o){e.defaultPasswordModifier||(e.defaultPasswordModifier=Object.assign(o.defaultPasswordModifier,e.defaultPasswordModifier));let t=null;e.messages&&e.messages.messageBoard&&(t=document.body.querySelector(e.messages.messageBoard));const s=document.body.querySelector(e.elements.passwordTarget);if(!s)return void d("ERROR.simplePass-I.1: Could not find a password target",{htmlMessage:t?{messageBoard:t}:void 0,consoleMessage:!0,level:"ERROR"},e);let a={};if(e.strengthCheck&&"object"==typeof e.strengthCheck){function r(e){Object.entries(e).forEach((([e,t])=>{if("string"==typeof t){const s=document.body.querySelector(t);s&&(a[e]=s)}else"object"==typeof t&&r(t)}))}r(e.strengthCheck)}const n=x(e.defaultPasswordModifier,e);if(n instanceof Promise?n.then((e=>{f(s,e,a)})):f(s,n,a),e.elements.actions){if(e.elements.actions.generate&&document.body.querySelector(e.elements.actions.generate)?.addEventListener("click",(function(){if(this instanceof HTMLButtonElement&&this.form&&"submit"===this.type)return;const t=x(e.defaultPasswordModifier,e);t instanceof Promise?t.then((e=>{f(s,e,a)})):f(s,t,a)})),e.elements.actions.form){const i=document.body.querySelector(e.elements.actions.form);if(i){if(i.addEventListener("submit",(function(s){s.preventDefault();const n=new FormData(this);let r=parseInt(n.get("passwordBatchAmount")?.toString()??"0")-1;const i=document.body.querySelector(e.elements.passwordContainer??".simplePass_passwordContainer");if(i)if(r&&r>0){const t=document.body.querySelector(".simplePass_passwordStatsIndex"),s=r+1;t&&(t.innerText=`(For Password: ${r+1})`),i.innerHTML="";const c=document.createElement("ol");for(;r--;){const s=document.createElement("li");s.dataset.simplePassIndex=(r+1).toString(),Object.assign(s.style,{cursor:"pointer"});const i=document.createElement("label");i.innerText="Password:";const o=document.createElement("input");o.type="text",o.classList.add(e.elements.passwordTarget.substring(1)),o.setAttribute("readonly","readonly"),i.appendChild(o),s.appendChild(i),c.prepend(s);const l=x(n);l instanceof Promise?l.then((e=>{f(o,e)})):f(o,l),"string"!=typeof l&&s.addEventListener("click",(function(){l instanceof Promise?l.then((e=>{C(e,a)})):C(l,a),t&&(t.innerText=`(For Password: ${s.dataset.simplePassIndex})`)}))}const o=document.createElement("li");o.dataset.simplePassIndex=s.toString();const l=document.createElement("label");l.innerText="Password:";const m=document.createElement("input");m.type="text",m.classList.add(e.elements.passwordTarget.substring(1)),m.setAttribute("readonly","readonly"),l.appendChild(m),o.appendChild(l),c.appendChild(o);const p=x(n);p instanceof Promise?p.then((e=>{f(m,e,a)})):f(m,p,a),i.prepend(c),"string"!=typeof p&&o.addEventListener("click",(function(){p instanceof Promise?p.then((e=>{C(e,a)})):C(p,a),t&&(t.innerText=`(For Password: ${o.dataset.simplePassIndex})`)}))}else if(i.querySelector("ol")){i.innerHTML="";const t=document.createElement("label");t.innerText="Password:";const s=document.createElement("input");s.classList.add(e.elements.passwordTarget.substring(1)),s.type="text",s.setAttribute("readonly","readonly"),t.appendChild(s),i.appendChild(t);const r=x(n,e);r instanceof Promise?r.then((e=>{f(s,e,a)})):f(s,r,a)}else{const s=document.body.querySelector(e.elements.passwordTarget);if(!s)return void d("ERROR.simplePass-I.2: Could not find a password target",{htmlMessage:t?{messageBoard:t}:void 0,consoleMessage:!0,level:"ERROR"},e);const r=x(n,e);r instanceof Promise?r.then((e=>{f(s,e,a)})):f(s,r,a)}else d("ERROR.simplePass-I.3: Use of batch password generation without a password container.",{htmlMessage:t?{messageBoard:t}:void 0,consoleMessage:!0,level:"ERROR"},e)})),e.defaultPasswordModifier)for(const[l,m]of Object.entries(e.defaultPasswordModifier)){const p=i.querySelector(`[name=${l}]`);p&&m&&("checkbox"===p.type||"radio"===p.type?p.checked=!0:p.value=m.toString())}const c=i.querySelectorAll("input[data-radioCheckbox]");c.forEach((e=>{e.addEventListener("click",(function(){c.forEach((e=>{e.value!==this.value&&e.checked&&(e.checked=!1)}))}))}))}}e.elements.actions.copy&&document.body.querySelector(e.elements.actions.copy)?.addEventListener("click",(function(){let s="";document.body.querySelectorAll(e.elements.passwordTarget).forEach(((e,t)=>{s+=t?`\n${u(e)}`:`${u(e)}`})),navigator.clipboard.writeText(s).then((()=>{this.style.backgroundColor="green",this.innerText="Copied!",setTimeout((()=>{this.toggleAttribute("style"),this.innerText="Copy"}),5e3)})).catch((s=>{d(`ERROR.simplePass-Ic.1: Unable to copy to clipboard! Environment Error: ${s.message}.`,{htmlMessage:t?{messageBoard:t}:void 0,consoleMessage:!0,level:"ERROR"},e)}))}))}};var _=t.A;export{_ as default};